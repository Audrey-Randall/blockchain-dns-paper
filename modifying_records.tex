\section{Modifying records}
\label{sec:modifying_records}

Malware authors must not only ensure their clients can access the blockchain 
naming system, but 
also ensure they can modify the addresses stored in the records when they 
become unavailable. The challenges of modifying records 
differ depending on whether the underlying blockchain is 
naming-specific or general-purpose.

\subsection{Challenges on general-purpose chains}
\randall{Say somewhere that reads don't cost anything, only writes}


Botnets often cycle through domain names and IP addresses for their C2 servers 
quickly, to replace 
blocklisted domains and IPs or prevent defenders from seizing 
them~\cite{nadji_beheading_2013}. 
Malware authors commonly use two strategies to cycle through records: fast 
flux and AGDs (Algorithmically Generated Domains). Fast flux 
is the practice of storing multiple records with low TTLs at a domain, and 
changing the records as 
soon as the TTL expires. This allows a domain to resolve to a different group 
of IP addresses every 
few minutes~\cite{holz_measuring_2008}. The IP addresses in question belong 
to a pool of 
compromised machines that can then route requests to the true C2 server. Fast 
flux increases the 
number of machines defenders must seize or neutralize, because if any of the 
compromised machines 
are still routing traffic, the system still works. However, fast flux is 
still vulnerable to domain 
takedowns. Malware authors address this weakness by cycling through domains as 
well as IP addresses. Each infected host knows how to generate a large number 
of potential domains, usually using the time or date as an input, but only a 
few of these domains will be registered at a time. Because the remainder are 
not registered, defenders cannot take them down preemptively. If a registered 
domain is taken down, malware authors simply register a new one, and the 
infected hosts all try to resolve each AGD in turn until they discover the new 
one. Defenders must 
register all of the domains that the infected hosts can generate to evade this 
threat entirely~\cite{antonakakis_throw-away_2012}. However, this strategy is 
often visible to a defender with a view into which DNS requests are made on a 
network, because infected hosts must try to resolve a large number of 
nonexistent domains.

Generally speaking, DNS domains are cheaper, easier to modify, and 
easier to replace than IP 
addresses, because each IP address represents a compromised machine while 
new domains can be 
purchased inexpensively. Blockchain-based domains on chains with high 
transaction costs, such as 
Bitcoin and Ethereum, change this norm. Malware authors must pay 
transaction fees, which can 
sometimes be quite high, to register or modify their domains. We found that 
registering a new name 
on the Unstoppable Domains service cost nearly \$80 in gas fees alone during a 
period of high fees. 
The cost of the name alone was \$10. While licit users may wait for fees to be 
low at times of low 
network congestion, malware authors may not have that choice, since they 
need to modify records as 
soon as possible after their previous records become blocklisted. Otherwise, 
their botnets might 
experience downtime. The high transaction cost poses challenges for 
defenders as well: it is 
impractical to pre-register every domain that a DGA can generate to prevent 
malware authors from 
registering them themselves. 

%\randall{Does it take longer to propagate modifications 
%through a blockchain 
%	than through DNS? Is this a challenge for malware bc it 
%introduces 
%	downtime? 
%	Someone said it could take half an hour for a txn to be 
%confirmed on a 
%	blockchain.}

\subsection{Challenges on naming-specific chains}
%\begin{itemize}
%	\item High txn cost is less of an issue: defenders might 
%	be able to register DGA domains? 
%	\item Blocking the whole thing using antivirus and 
%	middleboxes, or taking the whole thing down, is probably 
%	possible, because there's so few legit users. Even that 
%	one proxy stopped serving access to .bit domains. A 51\% 
%	attack is possible on Namecoin because one pool already 
%	had ~60\% of the hashing power. Also possible just to 
%	blocklist every IP recorded in the chain's domain records.
%\end{itemize}

Naming-specific blockchains, such as Namecoin, Emercoin, and Handshake, 
present 
a different set of tradeoffs for defenders and malware authors. These 
blockchains are created with the sole intention of hosting a naming system. 
With fewer users and correspondingly less demand, these systems' names are 
usually much less expensive than names in Ethereum-based systems. This enables 
malware 
authors to use fast flux or DGA-based strategies, and also may enable 
defenders 
to pre-register domains generated by DGAs. Additionally, low demand for 
these 
services from licit users enables interventions that would cause significant 
collateral damage on more popular blockchains. These interventions include 
blocklisting every record within the chain, blocking access to the chain 
entirely (e.g., from enterprise networks or ISPs' networks), or disabling 
its 
bootstrap nodes to prevent new peers from joining the blockchain.